[0;32m
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                   QTL Analysis Pipeline                      â•‘
â•‘                 Complete cis/trans Mapping                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[0m
[0;36m[STEP][0m ğŸš€ Starting Enhanced QTL Analysis Pipeline
[0;36m[STEP][0m Configuration Summary:
[0;34m[INFO][0m Project root:    /Users/singhvj/QTL_ANALYSIS
[0;34m[INFO][0m Data directory:  data
[0;34m[INFO][0m Output directory: test_results
[0;34m[INFO][0m Config file:     config/test_config.yaml
[0;34m[INFO][0m Analysis types:  all
[0;34m[INFO][0m QTL mode:        cis
[0;34m[INFO][0m GWAS analysis:   false
[0;34m[INFO][0m Validate only:   false
[0;34m[INFO][0m Debug mode:      true
[0;34m[INFO][0m Date:            Tue  7 Oct 2025 23:42:00 +08
[0;36m[STEP][0m Checking system requirements...
[0;32m[SUCCESS][0m All required tools are available
[0;34m[INFO][0m Tool versions:
[0;34m[INFO][0m   qtltools: 
version unknown
[0;34m[INFO][0m   bgzip: bgzip (htslib) 1.22.1
[0;34m[INFO][0m   tabix: tabix (htslib) 1.22.1
[0;34m[INFO][0m   bcftools: bcftools 1.22
[0;34m[INFO][0m   python3: Python 3.13.7
[0;36m[STEP][0m Checking Python dependencies...
[0;32m[SUCCESS][0m All Python dependencies are available
[0;36m[STEP][0m Setting up data directory structure...
[0;34m[INFO][0m Checking data files...
[0;34m[INFO][0m âœ… Found genotypes files
[0;34m[INFO][0m âœ… Found covariates files
[0;34m[INFO][0m âœ… Found annotations files
[0;36m[STEP][0m Running comprehensive input validation...
2025-10-07 23:42:02,977 - DEBUG - matplotlib data path: /Users/singhvj/miniconda3/lib/python3.13/site-packages/matplotlib/mpl-data
2025-10-07 23:42:02,979 - DEBUG - CONFIGDIR=/Users/singhvj/.matplotlib
2025-10-07 23:42:02,980 - DEBUG - interactive is False
2025-10-07 23:42:02,980 - DEBUG - platform is darwin
2025-10-07 23:42:03,006 - DEBUG - CACHEDIR=/Users/singhvj/.matplotlib
2025-10-07 23:42:03,007 - DEBUG - Using fontManager instance from /Users/singhvj/.matplotlib/fontlist-v390.json
2025-10-07 23:42:03,556 - QTLPipeline - INFO - ğŸš€ QTL Analysis Pipeline Started
2025-10-07 23:42:03,556 - QTLPipeline - INFO - ğŸ“ Results directory: test_results
2025-10-07 23:42:03,556 - QTLPipeline - INFO - ğŸ”§ Analysis mode: cis
ğŸ” Running comprehensive input validation...
ğŸ” Starting comprehensive input validation...
âœ… Found genotypes file: data/genotypes.vcf
ğŸ“ Detected genotype format: vcf
âœ… Found 10 samples in genotype file
âœ… Found 10 variants in genotype file
âœ… Found covariates file: data/covariates.txt
âœ… Covariates: 10 covariates, 10 samples
âœ… Found annotations file: data/annotations.bed
âœ… Annotations: 10 features
âœ… Found qtltools: qtltools
âœ… Found bcftools: bcftools 1.22
âœ… Found bgzip: bgzip (htslib) 1.22.1
âœ… Found tabix: tabix (htslib) 1.22.1
âœ… Found plink: plink
âœ… Found R: R
âœ… Genotype samples: 10
âœ… Covariate samples: 10
âœ… Genotype-covariate overlap: 10 samples (100.0%)

ğŸ‰ All inputs validated successfully!
âœ… All inputs validated successfully!
[0;32m[SUCCESS][0m Input validation completed successfully
[0;36m[STEP][0m Starting QTL analysis pipeline...
[0;34m[INFO][0m Running: python3 /Users/singhvj/QTL_ANALYSIS/run_QTLPipeline.py --config config/test_config.yaml --output-dir test_results --debug
2025-10-07 23:42:04,152 - DEBUG - matplotlib data path: /Users/singhvj/miniconda3/lib/python3.13/site-packages/matplotlib/mpl-data
2025-10-07 23:42:04,154 - DEBUG - CONFIGDIR=/Users/singhvj/.matplotlib
2025-10-07 23:42:04,155 - DEBUG - interactive is False
2025-10-07 23:42:04,155 - DEBUG - platform is darwin
2025-10-07 23:42:04,183 - DEBUG - CACHEDIR=/Users/singhvj/.matplotlib
2025-10-07 23:42:04,184 - DEBUG - Using fontManager instance from /Users/singhvj/.matplotlib/fontlist-v390.json
2025-10-07 23:42:04,728 - QTLPipeline - INFO - ğŸš€ QTL Analysis Pipeline Started
2025-10-07 23:42:04,728 - QTLPipeline - INFO - ğŸ“ Results directory: test_results
2025-10-07 23:42:04,728 - QTLPipeline - INFO - ğŸ”§ Analysis mode: cis
ğŸš€ Starting QTL Analysis Pipeline...
2025-10-07 23:42:04,728 - QTLPipeline - INFO - ğŸ“‹ Step 1: Validating inputs...
ğŸ” Starting comprehensive input validation...
âœ… Found genotypes file: data/genotypes.vcf
ğŸ“ Detected genotype format: vcf
âœ… Found 10 samples in genotype file
âœ… Found 10 variants in genotype file
âœ… Found covariates file: data/covariates.txt
âœ… Covariates: 10 covariates, 10 samples
âœ… Found annotations file: data/annotations.bed
âœ… Annotations: 10 features
âœ… Found qtltools: qtltools
âœ… Found bcftools: bcftools 1.22
âœ… Found bgzip: bgzip (htslib) 1.22.1
âœ… Found tabix: tabix (htslib) 1.22.1
âœ… Found plink: plink
âœ… Found R: R
âœ… Genotype samples: 10
âœ… Covariate samples: 10
âœ… Genotype-covariate overlap: 10 samples (100.0%)

ğŸ‰ All inputs validated successfully!
2025-10-07 23:42:04,868 - QTLPipeline - INFO - ğŸ§¬ Step 2: Preparing genotype data...
2025-10-07 23:42:04,868 - QTLPipeline - INFO - ğŸ”§ Preparing genotype data with enhanced processing...
2025-10-07 23:42:04,868 - QTLPipeline - INFO - ğŸ”§ Processing genotype file: data/genotypes.vcf
2025-10-07 23:42:04,868 - QTLPipeline - INFO - ğŸ“Š Input file size: 0.00 GB
2025-10-07 23:42:04,868 - QTLPipeline - INFO - ğŸ“ Detected input format: vcf
2025-10-07 23:42:04,868 - QTLPipeline - INFO - Executing: Compressing VCF file
2025-10-07 23:42:04,878 - QTLPipeline - INFO - âœ… Compressing VCF file completed successfully
2025-10-07 23:42:04,878 - QTLPipeline - INFO - ğŸ”§ Applying filter_variants...
2025-10-07 23:42:04,878 - QTLPipeline - INFO - Executing: Filtering variants
2025-10-07 23:42:04,889 - QTLPipeline - INFO - âœ… Filtering variants completed successfully
2025-10-07 23:42:04,889 - QTLPipeline - INFO - Executing: Indexing filtered VCF
2025-10-07 23:42:04,897 - QTLPipeline - INFO - âœ… Indexing filtered VCF completed successfully
2025-10-07 23:42:04,897 - QTLPipeline - INFO - ğŸ”§ Applying handle_multiallelic...
2025-10-07 23:42:04,897 - QTLPipeline - INFO - Executing: Splitting multi-allelic sites
2025-10-07 23:42:04,909 - QTLPipeline - INFO - âœ… Splitting multi-allelic sites completed successfully
2025-10-07 23:42:04,909 - QTLPipeline - INFO - Executing: Indexing biallelic VCF
2025-10-07 23:42:04,917 - QTLPipeline - INFO - âœ… Indexing biallelic VCF completed successfully
2025-10-07 23:42:04,917 - QTLPipeline - INFO - ğŸ”§ Applying normalize_chromosomes...
2025-10-07 23:42:04,917 - QTLPipeline - INFO - Executing: Adding 'chr' prefix to chromosomes
2025-10-07 23:42:04,930 - QTLPipeline - INFO - âœ… Adding 'chr' prefix to chromosomes completed successfully
2025-10-07 23:42:04,930 - QTLPipeline - INFO - Executing: Indexing chromosome-normalized VCF
2025-10-07 23:42:04,939 - QTLPipeline - INFO - âœ… Indexing chromosome-normalized VCF completed successfully
2025-10-07 23:42:04,939 - QTLPipeline - INFO - ğŸ”§ Applying remove_phasing...
2025-10-07 23:42:04,939 - QTLPipeline - INFO - Executing: Removing phasing information
2025-10-07 23:42:04,951 - QTLPipeline - INFO - âœ… Removing phasing information completed successfully
2025-10-07 23:42:04,951 - QTLPipeline - INFO - Executing: Indexing unphased VCF
2025-10-07 23:42:04,960 - QTLPipeline - INFO - âœ… Indexing unphased VCF completed successfully
2025-10-07 23:42:04,960 - QTLPipeline - INFO - ğŸ”§ Applying remove_duplicates...
2025-10-07 23:42:04,961 - QTLPipeline - INFO - Executing: Removing duplicate variants
2025-10-07 23:42:04,971 - QTLPipeline - INFO - âœ… Removing duplicate variants completed successfully
2025-10-07 23:42:04,972 - QTLPipeline - INFO - Executing: Indexing deduplicated VCF
2025-10-07 23:42:04,979 - QTLPipeline - INFO - âœ… Indexing deduplicated VCF completed successfully
2025-10-07 23:42:04,979 - QTLPipeline - INFO - ğŸ“Š Generating QC reports...
2025-10-07 23:42:04,980 - QTLPipeline - INFO - Executing: Generating VCF statistics
2025-10-07 23:42:04,991 - QTLPipeline - INFO - âœ… Generating VCF statistics completed successfully
2025-10-07 23:42:04,991 - QTLPipeline - INFO - Executing: Counting samples
2025-10-07 23:42:05,003 - QTLPipeline - INFO - âœ… Counting samples completed successfully
2025-10-07 23:42:05,003 - QTLPipeline - INFO - Executing: Counting variants
2025-10-07 23:42:05,015 - QTLPipeline - INFO - âœ… Counting variants completed successfully
2025-10-07 23:42:05,015 - QTLPipeline - INFO - âœ… QC reports generated
2025-10-07 23:42:05,015 - QTLPipeline - INFO - Executing: Creating final genotype file
2025-10-07 23:42:05,021 - QTLPipeline - INFO - âœ… Creating final genotype file completed successfully
2025-10-07 23:42:05,021 - QTLPipeline - INFO - Executing: Copying index file
2025-10-07 23:42:05,026 - QTLPipeline - INFO - âœ… Copying index file completed successfully
2025-10-07 23:42:05,027 - QTLPipeline - INFO - ğŸ” Validating VCF file structure...
2025-10-07 23:42:05,027 - QTLPipeline - INFO - Executing: Validating VCF header
2025-10-07 23:42:05,038 - QTLPipeline - INFO - âœ… VCF validation completed successfully
2025-10-07 23:42:05,039 - QTLPipeline - INFO - Executing: Counting final variants
2025-10-07 23:42:05,051 - QTLPipeline - INFO - Executing: Counting final samples
2025-10-07 23:42:05,063 - QTLPipeline - INFO - ğŸ“Š Final genotype data: 10 variants, 10 samples
2025-10-07 23:42:05,063 - QTLPipeline - INFO - âœ… Genotype processing completed: test_results/genotype_processing/final_genotypes.vcf.gz
2025-10-07 23:42:05,063 - QTLPipeline - INFO - âœ… Genotype preparation completed: test_results/genotype_processing/final_genotypes.vcf.gz
2025-10-07 23:42:05,063 - QTLPipeline - INFO - ğŸ” Step 3: Running QTL analyses...
2025-10-07 23:42:05,063 - QTLPipeline - INFO - ğŸ“ˆ Step 5: Generating plots...
2025-10-07 23:42:05,064 - QTLPipeline - INFO - âœ… Using seaborn style
2025-10-07 23:42:05,064 - QTLPipeline - WARNING - âš ï¸ No completed analyses for summary plot
2025-10-07 23:42:05,254 - QTLPipeline - INFO - ğŸ’¾ Saved plot: significance_comparison.png
2025-10-07 23:42:05,254 - QTLPipeline - INFO - ğŸ“ Step 6: Generating reports...
2025-10-07 23:42:05,254 - QTLPipeline - INFO - ğŸ“„ HTML report generated: test_results/reports/analysis_report.html
2025-10-07 23:42:05,254 - QTLPipeline - INFO - ğŸ“‹ Summary report generated: test_results/pipeline_summary.txt
2025-10-07 23:42:05,255 - QTLPipeline - INFO - ğŸ’¾ Results metadata saved: test_results/results_metadata.json
2025-10-07 23:42:05,255 - QTLPipeline - INFO - âœ… Pipeline completed successfully in 0:00:00.529653

================================================================================
ğŸ‰ QTL ANALYSIS PIPELINE COMPLETED SUCCESSFULLY!
================================================================================
ğŸ“ Results Directory: test_results
ğŸ“Š Analysis Mode:     cis
â±ï¸  Total Runtime:     0:00:00.529685

ğŸ“ˆ ANALYSIS SUMMARY
--------------------------------------------------------------------------------
QTL Results:

ğŸ“‹ OUTPUT FILES
--------------------------------------------------------------------------------
ğŸ“„ HTML Report:      test_results/reports/analysis_report.html
ğŸ“Š Plots Directory:  test_results/plots/
ğŸ“ˆ Results:          test_results/QTL_results/
ğŸ“ Logs:             test_results/logs/
ğŸ“‹ Summary:          test_results/pipeline_summary.txt

ğŸ’¡ NEXT STEPS
--------------------------------------------------------------------------------
1. Review the HTML report for comprehensive results
2. Check generated plots in the plots directory
3. Examine detailed results in QTL_results directory
4. Review logs for any warnings or additional information
================================================================================
[0;32m[SUCCESS][0m âœ… QTL analysis pipeline completed successfully
[0;36m[STEP][0m Generating final reports...
[0;32m[SUCCESS][0m HTML report: test_results/reports/analysis_report.html
[0;32m[SUCCESS][0m Summary report: test_results/pipeline_summary.txt
[0;34m[INFO][0m Output directory structure:
test_results
â”œâ”€â”€ genotype_processing
â”‚Â Â  â”œâ”€â”€ biallelic.vcf.gz
â”‚Â Â  â”œâ”€â”€ biallelic.vcf.gz.tbi
â”‚Â Â  â”œâ”€â”€ chrom_normalized.vcf.gz
â”‚Â Â  â”œâ”€â”€ chrom_normalized.vcf.gz.tbi
â”‚Â Â  â”œâ”€â”€ deduplicated.vcf.gz
â”‚Â Â  â”œâ”€â”€ deduplicated.vcf.gz.tbi
â”‚Â Â  â”œâ”€â”€ filtered.vcf.gz
â”‚Â Â  â”œâ”€â”€ filtered.vcf.gz.tbi
â”‚Â Â  â”œâ”€â”€ final_genotypes.vcf.gz
â”‚Â Â  â”œâ”€â”€ final_genotypes.vcf.gz.tbi
â”‚Â Â  â”œâ”€â”€ sample_count.txt
â”‚Â Â  â”œâ”€â”€ standardized.vcf.gz
â”‚Â Â  â”œâ”€â”€ unphased.vcf.gz
â”‚Â Â  â”œâ”€â”€ unphased.vcf.gz.tbi
â”‚Â Â  â”œâ”€â”€ variant_count.txt
â”‚Â Â  â””â”€â”€ vcf_stats.txt
â”œâ”€â”€ GWAS_results
â”œâ”€â”€ logs
â”‚Â Â  â”œâ”€â”€ pipeline_20251007_234203.log
â”‚Â Â  â””â”€â”€ pipeline_20251007_234204.log
â”œâ”€â”€ pipeline_summary.txt
â”œâ”€â”€ pipeline.log
â”œâ”€â”€ plots
â”‚Â Â  â””â”€â”€ significance_comparison.png
â”œâ”€â”€ QC_reports
â”œâ”€â”€ QTL_results
â”œâ”€â”€ reports
â”‚Â Â  â””â”€â”€ analysis_report.html
â”œâ”€â”€ results_metadata.json
â””â”€â”€ temp

9 directories, 23 files
[0;36m[STEP][0m ğŸ‰ PIPELINE COMPLETED SUCCESSFULLY!
[0;34m[INFO][0m Results available in: test_results
[0;34m[INFO][0m Log file: test_results/pipeline.log
[0;34m[INFO][0m HTML report: test_results/reports/analysis_report.html
[0;34m[INFO][0m Summary: test_results/pipeline_summary.txt

[0;36m[STEP][0m ğŸ“‹ NEXT STEPS:
[0;34m[INFO][0m 1. Review the HTML report: test_results/reports/analysis_report.html
[0;34m[INFO][0m 2. Check generated plots: test_results/plots/
[0;34m[INFO][0m 3. Examine detailed results: test_results/QTL_results/
[0;34m[INFO][0m 4. Review logs for any warnings: test_results/logs/
[0;32m[SUCCESS][0m Pipeline completed successfully
